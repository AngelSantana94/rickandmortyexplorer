(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))t(a);new MutationObserver(a=>{for(const n of a)if(n.type==="childList")for(const c of n.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&t(c)}).observe(document,{childList:!0,subtree:!0});function r(a){const n={};return a.integrity&&(n.integrity=a.integrity),a.referrerPolicy&&(n.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?n.credentials="include":a.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function t(a){if(a.ep)return;a.ep=!0;const n=r(a);fetch(a.href,n)}})();function M(o,e){const r=Array.isArray(o)?o:[o],t=document.createElement("div");t.className="universal-list-wrapper";const a=document.createElement("h3");a.className="list-section-title",e==="character"?a.textContent="Characters:":e==="episode"?a.textContent="Episodes:":e==="location"&&(a.textContent="Locations:"),t.appendChild(a);const n=document.createElement("div");n.className=`universal-list-container list-${e}`;for(const c of r){const i=document.createElement("div");if(i.className="mini-card",e==="character"){const s=document.createElement("img");s.src=c.image,s.className="mini-img";const l=document.createElement("strong");l.textContent=c.name;const C=document.createElement("p");C.textContent=`Status: ${c.status}`,i.append(s,l,C)}else if(e==="episode"){const s=document.createElement("h4");s.className="fullscreen-episode-name",s.textContent=c.name;const l=document.createElement("p");l.className="fullscreen-episode-number",l.textContent=`Code: ${c.episode}`,i.append(s,l)}else if(e==="location"){const s=document.createElement("h4");s.textContent=c.name;const l=document.createElement("p");l.textContent=`Type: ${c.type}`;const C=document.createElement("p");C.textContent=`Dim: ${c.dimension}`,i.append(s,l,C)}n.appendChild(i)}return t.appendChild(n),t}async function q(o,e){const r=document.querySelector("#app");r.innerHTML="";for(let t of o.results){const a=document.createElement("div");a.className="container-element";const n=document.createElement("div");n.className="container-info-element";const c=document.createElement("h3");if(c.className="info-name",c.textContent=t.name,n.appendChild(c),e==="character"){const d=document.createElement("div");d.className="div-img-character",a.appendChild(d);const p=document.createElement("img");p.className="img-character",p.src=t.image,d.appendChild(p);const u=document.createElement("p");u.className="info-status",u.textContent=`Status: ${t.status}`,n.appendChild(u),n.classList.add(`status-${t.status.toLowerCase()}`);const y=document.createElement("p");y.className="info-species",y.textContent=`Species: ${t.species}`,n.appendChild(y);const m=document.createElement("p");m.className="info-origins",m.textContent=`Origin: ${t.origin.name}`,n.appendChild(m);const h=document.createElement("p");h.className="info-location",h.textContent=`Location: ${t.location.name}`,n.appendChild(h)}if(e==="location"){const d=document.createElement("p");d.className="info-type",d.textContent=`Type: ${t.type}`,n.appendChild(d);const p=document.createElement("p");p.className="info-dimension",p.textContent=`Dimension: ${t.dimension}`,n.appendChild(p);const u=document.createElement("p");u.className="info-residents"}if(e==="episode"){const d=document.createElement("p");d.className="info-episode",d.textContent=`Episode: ${t.episode}`,n.appendChild(d);const p=document.createElement("p");p.className="air-date",p.textContent=`Air date: ${t.air_date}`,n.appendChild(p)}const i=document.createElement("div");i.className="fullscreen-overlay",i.style.display="none";const s=document.createElement("div");s.className="modal-content";const l=document.createElement("button");l.className="close-btn";const C=document.createElement("img");C.className="img-close-btn",C.src="img/close.svg",l.appendChild(C),i.appendChild(s),l.addEventListener("click",()=>{i.style.display="none"}),a.appendChild(n),r.appendChild(i),r.appendChild(a),a.addEventListener("click",async()=>{let d=i.querySelector(".modal-content");d||(d=document.createElement("div"),d.className="modal-content",i.appendChild(d)),d.innerHTML="";const p=document.createElement("div");if(p.className="modal-header",t.image){const m=document.createElement("img");m.className="modal-img-header",m.src=t.image,p.appendChild(m)}const u=document.createElement("div");u.className="modal-info-text";const y=document.createElement("h2");if(y.textContent=t.name,u.appendChild(y),e==="character"?u.innerHTML+=`
                <p><span class="status-tag">Status: ${t.status}</span></p>
                <p><strong>Species:</strong> ${t.species}</p>
                <p><strong>Origin:</strong> ${t.origin.name}</p>
                <p><strong>Last Location:</strong> ${t.location.name}</p>
            `:e==="location"?u.innerHTML+=`
                <p><strong>Type:</strong> ${t.type}</p>
                <p><strong>Dimension:</strong> ${t.dimension}</p>
            `:e==="episode"&&(u.innerHTML+=`
                <p><strong>Episode Code:</strong> ${t.episode}</p>
                <p><strong>Air Date:</strong> ${t.air_date}</p>
            `),p.appendChild(u),p.appendChild(l),d.appendChild(p),console.log("Cargando lista de detalles..."),e==="character"){const m=t.episode.map(O=>O.split("/").pop()),$=await(await fetch(`https://rickandmortyapi.com/api/episode/${m.join(",")}`)).json();d.appendChild(M($,"episode"))}else if(e==="location"){const m=t.residents.map(h=>h.split("/").pop());if(m.length>0){const $=await(await fetch(`https://rickandmortyapi.com/api/character/${m.join(",")}`)).json();d.appendChild(M($,"character"))}}else if(e==="episode"){const m=t.characters.map(h=>h.split("/").pop());if(m.length>0){const $=await(await fetch(`https://rickandmortyapi.com/api/character/${m.join(",")}`)).json();d.appendChild(M($,"character"))}}i.style.display="flex"})}}const I=(o,e,r)=>{const t=document.querySelector(".paginacion-container");if(!t)return;t.innerHTML="";const a=2,n=[];n.push(1),e>a+2&&n.push("...");let c=Math.max(2,e-a),i=Math.min(o-1,e+a);for(let s=c;s<=i;s++)n.push(s);e<o-(a+1)&&n.push("..."),o>1&&n.push(o),n.forEach(s=>{const l=document.createElement("span");l.textContent=s,l.className=s===e?"page-btn active":"page-btn",s==="..."?l.classList.add("ellipsis"):l.addEventListener("click",()=>{r(s)}),t.appendChild(l)})},x=document.querySelector("#header"),E=document.querySelector("#app"),w=document.querySelector(".paginacion-container"),H=document.querySelector("#searchInput"),b=document.querySelector("#search-form"),L=document.querySelector("#selectEpisodes"),N=document.querySelector("#selectLocations");let f="",T=1,v=!1,g={episode:"",location:""};const S=async()=>{if(!(v||!f)){v=!0;try{E.innerHTML="<div class='loader'>Cargando...</div>";const e=await(await fetch(`https://rickandmortyapi.com/api/${f}/?page=${T}`)).json();if(e.error){E.innerHTML='<p class="error">No se encontraron resultados.</p>',w.innerHTML="";return}E.innerHTML="",q(e,f),w.innerHTML="",e.info&&e.info.pages>1&&I(e.info.pages,T,r=>{T=r,window.scrollTo(0,0),S()})}catch(o){console.error("Errorazo:",o)}finally{v=!1}}},j=async o=>{if(!v){v=!0;try{E.innerHTML="<div class='loader'>Buscando...</div>";const r=await(await fetch(o)).json();E.innerHTML="";const t=Array.isArray(r)?{results:r}:r;t.error?E.innerHTML="<p class='error'>No se encontraron resultados.</p>":q(t,f),w.innerHTML=""}catch(e){console.error("Error en búsqueda externa:",e)}finally{v=!1}}};async function A(o,e,r,t){if(e==="search"){const i=`https://rickandmortyapi.com/api/${r}/?name=${o}`;return t(i)}if(e==="filter-episode"&&(g.episode=o),e==="filter-location"&&(g.location=o),g.episode===""&&g.location==="")return S();let a=null;g.episode!==""&&(a=(await(await fetch(`https://rickandmortyapi.com/api/episode/${g.episode}`)).json()).characters.map(l=>l.split("/").pop()));let n=null;g.location!==""&&(n=(await(await fetch(`https://rickandmortyapi.com/api/location/${g.location}`)).json()).residents.map(l=>l.split("/").pop()));let c=[];a&&n?c=a.filter(i=>n.includes(i)):c=a||n||[],c.length>0?t(`https://rickandmortyapi.com/api/character/${c.join(",")}`):E.innerHTML="<p class='error'>No hay coincidencias en esta dimensión.</p>"}x.addEventListener("click",o=>{const e=o.target.closest(".main__title"),r=o.target.closest(".nav-btn");if(e){x.classList.add("is-intro"),E.innerHTML="",w.innerHTML="",H&&(H.value="");return}r&&(x.classList.remove("is-intro"),f=r.id,T=1,g={episode:"",location:""},L&&(L.value=""),N&&(N.value=""),D(),S())});b&&b.addEventListener("submit",o=>{o.preventDefault(),o.stopPropagation();const e=H.value.trim();e.length>=2?(x.classList.remove("is-intro"),L&&(L.value=""),N&&(N.value=""),g={episode:"",location:""},f||(f="character"),A(e,"search",f,j)):e.length===0&&S()});L&&L.addEventListener("change",o=>{A(o.target.value,"filter-episode",f,j)});N&&N.addEventListener("change",o=>{A(o.target.value,"filter-location",f,j)});function D(){const o=document.querySelectorAll("#selectEpisodes, #selectLocations"),e=f==="character"?"block":"none";o.forEach(r=>r.style.display=e)}const k=async o=>{try{const r=await(await fetch(`https://rickandmortyapi.com/api/${o}`)).json(),t=Array.from({length:r.info.count},(i,s)=>s+1),n=await(await fetch(`https://rickandmortyapi.com/api/${o}/${t.join(",")}`)).json(),c=document.querySelector(o==="episode"?"#selectEpisodes":"#selectLocations");n.forEach(i=>{let s=document.createElement("option");s.value=i.id,s.textContent=o==="episode"?`${i.name} (${i.episode})`:i.name,c.appendChild(s)})}catch(e){console.error(`Error llenando select ${o}:`,e)}};x.classList.add("is-intro");k("episode");k("location");
